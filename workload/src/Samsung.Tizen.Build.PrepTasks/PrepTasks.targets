<Project>

  <UsingTask TaskName="ReplaceFileContents" TaskFactory="RoslynCodeTaskFactory" AssemblyFile="$(MSBuildToolsPath)\Microsoft.Build.Tasks.Core.dll">
    <ParameterGroup>
      <SourceFile ParameterType="Microsoft.Build.Framework.ITaskItem" Required="true" />
      <DestinationFile ParameterType="Microsoft.Build.Framework.ITaskItem" Required="true" />
      <Replacements ParameterType="System.String[]" />
      <ReplacementFilePath ParameterType="System.String" />
    </ParameterGroup>
    <Task>
      <Code Type="Class" Language="cs" Source="$(MSBuildThisFileDirectory)ReplaceFileContents.cs"/>
    </Task>
  </UsingTask>

  <UsingTask TaskName="GenerateWixFile" TaskFactory="RoslynCodeTaskFactory" AssemblyFile="$(MSBuildToolsPath)\Microsoft.Build.Tasks.Core.dll">
    <ParameterGroup>
      <ProductName ParameterType="System.String" Required="true" />
      <ProductCode ParameterType="System.String" Required="true" />
      <ProductVersion ParameterType="System.String" Required="true" />
      <WorkloadVersion ParameterType="System.String" Required="true" />
      <UpgradeCode ParameterType="System.String" Required="true" />
      <SourceFile ParameterType="Microsoft.Build.Framework.ITaskItem" Required="true" />
      <DestinationFile ParameterType="Microsoft.Build.Framework.ITaskItem" Required="true" />
      <BaseDirectory ParameterType="System.String" Required="true" />
      <SourceDirectory ParameterType="System.String" Required="true" />
    </ParameterGroup>
    <Task>
      <Code Type="Class" Language="cs" Source="$(MSBuildThisFileDirectory)GenerateWixFile.cs"/>
    </Task>
  </UsingTask>

</Project>